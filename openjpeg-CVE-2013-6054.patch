diff --git a/libopenjpeg/j2k.c b/libopenjpeg/j2k.c
index 26462c1..cb6f3a2 100755
--- a/libopenjpeg/j2k.c
+++ b/libopenjpeg/j2k.c
@@ -908,6 +908,13 @@ static void j2k_read_qcx(opj_j2k_t *j2k, int compno, int len) {
 		};
 
 	};
+#else
+	/* We check whether there are too many subbands */
+	if ((numbands < 0) || (numbands >= J2K_MAXBANDS)) {
+		opj_event_msg(j2k->cinfo, EVT_WARNING ,
+					"bad number of subbands in Sqcx (%d) regarding to J2K_MAXBANDS (%d) \n"
+					"- limiting number of bands to J2K_MAXBANDS and try to move to the next markers\n", numbands, J2K_MAXBANDS);
+	}
 #endif /* USE_JPWL */
 
 	for (bandno = 0; bandno < numbands; bandno++) {
@@ -920,8 +927,10 @@ static void j2k_read_qcx(opj_j2k_t *j2k, int compno, int len) {
 			expn = tmp >> 11;
 			mant = tmp & 0x7ff;
 		}
-		tccp->stepsizes[bandno].expn = expn;
-		tccp->stepsizes[bandno].mant = mant;
+        if (bandno < J2K_MAXBANDS) {
+            tccp->stepsizes[bandno].expn = expn;
+            tccp->stepsizes[bandno].mant = mant;
+        }
 	}
 	
 	/* Add Antonin : if scalar_derived -> compute other stepsizes */
